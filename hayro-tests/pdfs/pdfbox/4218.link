https://issues.apache.org/jira/secure/attachment/12922800/image_via_1.3_006.pdf